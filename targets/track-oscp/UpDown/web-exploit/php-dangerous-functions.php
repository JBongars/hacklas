<h1>danger.php</h1>

<?php
// Dangerous PHP Functions Checker
// Usage: Upload and visit in browser


$functions = [
    // Command Execution
    'exec','passthru','system','shell_exec','popen','proc_open','pcntl_exec',

    // PHP Code Execution
    'eval','assert','create_function','include','include_once','require','require_once',

    // Callbacks
    'call_user_func','call_user_func_array','preg_replace_callback','spl_autoload_register',
    'register_shutdown_function','register_tick_function','set_error_handler','set_exception_handler',
    'array_map','array_filter','array_reduce','array_walk','array_walk_recursive',
    'usort','uasort','uksort','iterator_apply','ob_start',

    // Info Disclosure
    'phpinfo','posix_mkfifo','posix_getlogin','posix_ttyname','getenv','get_current_user',
    'proc_get_status','get_cfg_var','disk_free_space','disk_total_space','getcwd',
    'getmygid','getmyinode','getmypid','getmyuid',

    // Filesystem
    'fopen','tmpfile','bzopen','gzopen','chgrp','chmod','chown','copy',
    'file_put_contents','link','mkdir','move_uploaded_file','rename','rmdir',
    'symlink','tempnam','touch','unlink','file_get_contents','file','readfile',
    'parse_ini_file','highlight_file','show_source','php_strip_whitespace','ftp_get','ftp_put',

    // Other
    'extract','parse_str','putenv','ini_set','mail','header','proc_nice',
    'proc_terminate','proc_close','pfsockopen','fsockopen','apache_child_terminate',
    'posix_kill','posix_setpgid','posix_setsid','posix_setuid',
];

echo "=== Dangerous PHP Functions Check ===\n\n";
echo "PHP Version: " . phpversion() . "\n\n";

echo "--- CALLABLE ---\n";
foreach ($functions as $f) {
    if (is_callable($f)) {
        echo "[!] $f\n";
    }
}
?>

